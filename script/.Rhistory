}
final_plot_analysis_2 <- patchwork::wrap_plots(plot_list, ncol = 3)
final_plot_analysis_2+ggview::canvas(width = 400,height = 200*2/3, units = "mm", dpi = 320)
print(final_plot_analysis_2)
ggplot2::ggsave(
filename = '../figure/final_plot_analysis_2.jpg',
plot = final_plot_analysis_2,
width = 400,
height = 200*2/3,
units = "mm",
dpi = 320
)
model_list_analysis_2 <- readRDS("../results/model_list_analysis_2_partial_pooling.rds")
a = as.data.frame(model_list_analysis_2[[1]])
summary(model_list_analysis_2[[1]])
plot_list <- list()
for (m in seq_along(model_list_analysis_2)){
model <- model_list_analysis_2[[m]]
model_name <- names(model_list_analysis_2)[[m]]
trace_par_cue2vs1 <- as.data.frame(model)$b_cue_dimensionality2
trace_par_cue3vs1 <- as.data.frame(model)$b_cue_dimensionality3
trace_par_cue4vs1 <- as.data.frame(model)$b_cue_dimensionality4
trace_par_cue3vs2 = trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 = trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 = trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.1,0.1))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.1,0.1))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.1,0.1))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
p_4vs2 <- plot(rope_res_3, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs2'))
p_4vs3 <- plot(rope_res_4, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs3'))
plot_list <- c(plot_list, p_3vs2, p_4vs2, p_4vs3)
}
final_plot_analysis_2 <- patchwork::wrap_plots(plot_list, ncol = 3)
final_plot_analysis_2+ggview::canvas(width = 400,height = 200*2/3, units = "mm", dpi = 320)
ggplot2::ggsave(
filename = '../figure/final_plot_analysis_2.jpg',
plot = final_plot_analysis_2,
width = 400,
height = 200*2/3,
units = "mm",
dpi = 320
)
p_acc = ggplot(data = data_analysis, mapping = aes(x = cue_dimensionality, y = mean_acc, fill = cue_dimensionality)) +
sm_raincloud() +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
p_rt = ggplot(data = data_analysis, mapping = aes(x = cue_dimensionality, y = media_rt, fill = cue_dimensionality)) +
sm_raincloud() +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
p_acc+p_rt+ggview::canvas(width = 300,height = 200*2/3, units = "mm", dpi = 320)
p_analysis_2_describe = p_acc+p_rt
ggplot2::ggsave(
filename = '../figure/p_analysis_2_describe.jpg',
plot = p_analysis_2_describe,
width = 300,
height = 200*2/3,
units = "mm",
dpi = 320
)
model_list_analysis_2 <- readRDS("../results/model_list_analysis_2_partial_pooling.rds")
a = as.data.frame(model_list_analysis_2[[1]])
summary(model_list_analysis_2[[1]])
plot_list <- list()
for (m in seq_along(model_list_analysis_2)){
model <- model_list_analysis_2[[m]]
model_name <- names(model_list_analysis_2)[[m]]
trace_par_cue2vs1 <- as.data.frame(model)$b_cue_dimensionality2
trace_par_cue3vs1 <- as.data.frame(model)$b_cue_dimensionality3
trace_par_cue4vs1 <- as.data.frame(model)$b_cue_dimensionality4
trace_par_cue3vs2 = trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 = trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 = trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.1,0.1))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.1,0.1))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.1,0.1))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
p_4vs2 <- plot(rope_res_3, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs2'))
p_4vs3 <- plot(rope_res_4, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs3'))
plot_list <- c(plot_list, p_3vs2, p_4vs2, p_4vs3)
}
final_plot_analysis_2 <- patchwork::wrap_plots(plot_list, ncol = 3)
final_plot_analysis_2+ggview::canvas(width = 400,height = 200*2/3, units = "mm", dpi = 320)
ggplot2::ggsave(
filename = '../figure/final_plot_analysis_2.jpg',
plot = final_plot_analysis_2,
width = 400,
height = 200*2/3,
units = "mm",
dpi = 320
)
View(b)
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
View(hdi_2)
model_a <- readRDS("../results/model_a.rds")
model_a <- readRDS("../results/hddm/model_a.rds")
library(brms)
library(tidyverse)
library(bruceR)
library(bayestestR)
library(papaja)
library(smplot2)
library(patchwork)
PATH_DIC <- '../results/hddm/dic_model_full.csv'
PATH_A <- '../results/hddm/data_posterior_a.csv'
PATH_V <- '../results/hddm/data_posterior_v.csv'
PATH_T <- '../results/hddm/data_posterior_t.csv'
model_a <- readRDS("../results/hddm/model_a.rds")
model_a <- readRDS("../results/hddm/statistic_inference/model_a.rds")
model_v <- readRDS("../results/hddm/statistic_inference/model_v.rds")
model_t <- readRDS("../results/hddm/statistic_inference/model_t.rds")
a <- as.data.frame(model_a)
View(a)
model_a <- readRDS("../results/hddm/statistic_inference/model_a.rds")
model_v <- readRDS("../results/hddm/statistic_inference/model_v.rds")
model_t <- readRDS("../results/hddm/statistic_inference/model_t.rds")
trace_par_cue2vs1 <- as.data.frame(model_a)$b_cue_dimensionality2
trace_par_cue3vs1 <- as.data.frame(model_a)$b_cue_dimensionality3
trace_par_cue4vs1 <- as.data.frame(model_a)$b_cue_dimensionality4
trace_par_cue3vs2 = trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 = trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 = trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.1,0.1))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.1,0.1))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.1,0.1))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
View(rope_res_2)
a = as.data.frame(model_a)
View(a)
View(a)
model_a <- readRDS("../results/hddm/statistic_inference/model_a.rds")
model_v <- readRDS("../results/hddm/statistic_inference/model_v.rds")
model_t <- readRDS("../results/hddm/statistic_inference/model_t.rds")
trace_par_cue2vs1 <- as.data.frame(model_a)$b_cue_dimensionalitya.2.
trace_par_cue3vs1 <- as.data.frame(model_a)$b_cue_dimensionalitya.3.
trace_par_cue4vs1 <- as.data.frame(model_a)$b_cue_dimensionalitya.4.
trace_par_cue3vs2 = trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 = trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 = trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.1,0.1))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.1,0.1))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.1,0.1))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
View(rope_res_2)
View(a)
a=as.data.frame(model_a)[,2]
a
model_a <- readRDS("../results/hddm/statistic_inference/model_a.rds")
model_v <- readRDS("../results/hddm/statistic_inference/model_v.rds")
model_t <- readRDS("../results/hddm/statistic_inference/model_t.rds")
trace_par_cue2vs1 <- as.data.frame(model_a)[,2]
trace_par_cue3vs1 <- as.data.frame(model_a)[,3]
trace_par_cue4vs1 <- as.data.frame(model_a)[,4]
trace_par_cue3vs2 = trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 = trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 = trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.1,0.1))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.1,0.1))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.1,0.1))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
p_4vs2 <- plot(rope_res_3, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs2'))
p_4vs3 <- plot(rope_res_4, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs3'))
plot_list_a <- c(p_3vs2, p_4vs2, p_4vs3)
final_plot_a <- patchwork::wrap_plots(plot_list_a, ncol = 2)
final_plot_a+ggview::canvas(width = 400,height = 200*2/3, units = "mm", dpi = 320)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, c(0))
View(hdi_3vs2)
model_a <- readRDS("../results/hddm/statistic_inference/model_a.rds")
model_v <- readRDS("../results/hddm/statistic_inference/model_v.rds")
model_t <- readRDS("../results/hddm/statistic_inference/model_t.rds")
trace_par_cue2vs1 <- as.data.frame(model_a)[,2]
trace_par_cue3vs1 <- as.data.frame(model_a)[,3]
trace_par_cue4vs1 <- as.data.frame(model_a)[,4]
trace_par_cue3vs2 = trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 = trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 = trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.001,0.001))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.001,0.001))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.001,0.001))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
p_4vs2 <- plot(rope_res_3, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs2'))
p_4vs3 <- plot(rope_res_4, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs3'))
plot_list_a <- c(p_3vs2, p_4vs2, p_4vs3)
final_plot_a <- patchwork::wrap_plots(plot_list_a, ncol = )
final_plot_a+ggview::canvas(width = 400,height = 200*2/3, units = "mm", dpi = 320)
final_plot_a <- patchwork::wrap_plots(plot_list_a, ncol = )
final_plot_a+ggview::canvas(width = 400,height = 100*2/3, units = "mm", dpi = 320)
model_a <- readRDS("../results/hddm/statistic_inference/model_a.rds")
model_v <- readRDS("../results/hddm/statistic_inference/model_v.rds")
model_t <- readRDS("../results/hddm/statistic_inference/model_t.rds")
model_list <- {model_a, model_v, model_t}
model_list <- (model_a, model_v, model_t)
model_list <- list(model_a, model_v, model_t)
a = name(model_a)
a = names(model_a)
a = names(model_a)[1]
View(model_a)
model_names <- c("model_a", "model_v", "model_t")
model_paths <- paste0("../results/hddm/statistic_inference/", model_names, ".rds")
model_list <- lapply(model_paths, readRDS)
for (i in seq_along(model_names)) {
model_name <- model_names[i]
model <- model_list[[i]]
trace_par_cue2vs1 <- as.data.frame(model)[,2]
trace_par_cue3vs1 <- as.data.frame(model)[,3]
trace_par_cue4vs1 <- as.data.frame(model)[,4]
trace_par_cue3vs2 <- trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 <- trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 <- trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.001,0.001))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.001,0.001))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.001,0.001))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
p_4vs2 <- plot(rope_res_3, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs2'))
p_4vs3 <- plot(rope_res_4, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs3'))
plot_list_a <- c(p_3vs2, p_4vs2, p_4vs3)
final_plot_a <- patchwork::wrap_plots(plot_list_a, ncol = )
final_plot_a+ggview::canvas(width = 400,height = 100*2/3, units = "mm", dpi = 320)
ggplot2::ggsave(
filename = paste0("../figure/final_plot_", sub("model_", "", model_name), ".jpg"),
plot = final_plot,
width = 400,
height = 100 * 2 / 3,
units = "mm",
dpi = 320
)
}
model_names <- c("model_a", "model_v", "model_t")
model_paths <- paste0("../results/hddm/statistic_inference/", model_names, ".rds")
model_list <- lapply(model_paths, readRDS)
for (i in seq_along(model_names)) {
model_name <- model_names[i]
model <- model_list[[i]]
trace_par_cue2vs1 <- as.data.frame(model)[,2]
trace_par_cue3vs1 <- as.data.frame(model)[,3]
trace_par_cue4vs1 <- as.data.frame(model)[,4]
trace_par_cue3vs2 <- trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 <- trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 <- trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.001,0.001))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.001,0.001))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.001,0.001))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
p_4vs2 <- plot(rope_res_3, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs2'))
p_4vs3 <- plot(rope_res_4, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs3'))
final_plot <- patchwork::wrap_plots(p_3vs2, p_4vs2, p_4vs3, ncol = 3)
final_plot_a <- patchwork::wrap_plots(plot_list_a, ncol = )
final_plot_a+ggview::canvas(width = 400,height = 100*2/3, units = "mm", dpi = 320)
ggplot2::ggsave(
filename = paste0("../figure/final_plot_", sub("model_", "", model_name), ".jpg"),
plot = final_plot,
width = 400,
height = 100 * 2 / 3,
units = "mm",
dpi = 320
)
}
library(brms)
library(tidyverse)
library(bruceR)
library(bayestestR)
library(papaja)
library(smplot2)
library(patchwork)
# Configuration and Constants
PATH_RAW_DATA = '../data/behaviorData'
SUBJECT_IDX <- paste0("sub-STSWD", c(
1117,1118,1120,1126,1131,1132,1135,1136,
1151,1160,1164,1167,1169,1172,1173,1178,
1182,1215,1216,1219,1223,1227,1228,1233,
1234,1237,1240,1243,1245,1247,1250,1239,
1252,1257,1261,1265,1266,1268,1270,1276,1281
))
BIDS_TASK_LABEL_BEH = '_task-MAT_behavEEG'
probe_idx <- c('1','2','3','4')
cue_levels <- c('1', '4')
# Load behavior data and merge into a full dataframe.
behavior_list <- list()
for (sub_idx in SUBJECT_IDX) {
# cat("Processing subject:", sub_idx, "\n")
# Set path
path_beh <- file.path(
PATH_RAW_DATA,
paste0(sub_idx, BIDS_TASK_LABEL_BEH, ".csv")
)
# Check the path
if (!file.exists(path_beh)) stop("Behavior file not found: ", path_beh)
# Load behavior data
data_behavior <- read.csv(path_beh, sep = ",", header = TRUE, check.names = FALSE)
# Add 'subj_idx'
data_behavior['subj_idx'] <- sub_idx
data_behavior$subj_idx <- str_remove(sub_idx, "sub-STSWD")
# Make a list
behavior_list[[sub_idx]] <- data_behavior
}
data_behavior_full <- bind_rows(behavior_list)
data_behavior_full$probe_attribute <- as.factor(data_behavior_full$probe_attribute)
data_behavior_full$cue_dimensionality <- as.factor(data_behavior_full$cue_dimensionality)
# Drop missing values
data_behavior_full <- data_behavior_full %>%
dplyr::filter(!is.na(probe_accuracy))
# Data for analysis
data_analysis <- data_behavior_full %>%
group_by(subj_idx, probe_attribute, cue_dimensionality) %>%
summarise(
mean_acc = mean(probe_accuracy, na.rm = TRUE),
media_rt = median(probe_rt, na.rm = TRUE),
.groups = "drop"
)
# Data plot for analysis 1
data_plot_analysis_1 <- data_behavior_full %>%
dplyr::filter(
#probe_attribute == probe_idx,
cue_dimensionality %in% cue_levels
)%>%
group_by(subj_idx, probe_attribute, cue_dimensionality) %>%
summarise(
mean_acc = mean(probe_accuracy, na.rm = TRUE),
.groups = "drop"
)
# Set Bayesian model and sampling
# Model4ACC
models_list_analysis_2 <- list()
model_acc <- brms::brm(
mean_acc ~ 1 + cue_dimensionality + (1 + cue_dimensionality|subj_idx),
data = data_analysis,
family = gaussian(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
model_name_acc <- paste0("model_acc_analysis_2")
models_list_analysis_2[[model_name_acc]] <- model_acc
# Model4RT
model_rt <- brms::brm(
media_rt ~ 1 + cue_dimensionality + (1 + cue_dimensionality|subj_idx),
data = data_analysis,
family = lognormal(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
model_name_rt <- paste0("model_rt_analysis_2")
model_list_analysis_2[[model_name_rt]] <- model_rt
# Set Bayesian model and sampling
# Model4ACC
models_list_analysis_2 <- list()
model_acc <- brms::brm(
mean_acc ~ 1 + cue_dimensionality + (1 + cue_dimensionality|subj_idx),
data = data_analysis,
family = gaussian(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
model_name_acc <- paste0("model_acc_analysis_2")
models_list_analysis_2[[model_name_acc]] <- model_acc
# Model4RT
model_rt <- brms::brm(
media_rt ~ 1 + cue_dimensionality + (1 + cue_dimensionality|subj_idx),
data = data_analysis,
family = lognormal(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
model_name_rt <- paste0("model_rt_analysis_2")
models_list_analysis_2[[model_name_rt]] <- model_rt
saveRDS(model_list_analysis_2, "../results/model_list_analysis_2_partial_pooling.rds")
saveRDS(models_list_analysis_2, "../results/model_list_analysis_2_partial_pooling.rds")
model_diagnostics <- function(model_list) {
# Set dataframe to save data
results <- data.frame(
model_name = names(model_list),
Rhat = NA,
bulk_ESS = NA
)
# Summary and extract value
for (i in seq_along(model_list)) {
m <- model_list[[i]]
m_summary = summary(m)
results$Rhat[i] <- m_summary$fixed$Rhat
results$bulk_ESS[i] <- m_summary$fixed$Bulk_ESS
}
return(results)
}
diagnosis_table_analysis_2 <- model_diagnostics(models_list_analysis_2)
print(diagnosis_table_analysis_2)
model_list_analysis_2 <- readRDS("../results/model_list_analysis_2_partial_pooling.rds")
a = as.data.frame(model_list_analysis_2[[1]])
summary(model_list_analysis_2[[1]])
plot_list <- list()
for (m in seq_along(model_list_analysis_2)){
model <- model_list_analysis_2[[m]]
model_name <- names(model_list_analysis_2)[[m]]
trace_par_cue2vs1 <- as.data.frame(model)$b_cue_dimensionality2
trace_par_cue3vs1 <- as.data.frame(model)$b_cue_dimensionality3
trace_par_cue4vs1 <- as.data.frame(model)$b_cue_dimensionality4
trace_par_cue3vs2 = trace_par_cue3vs1-trace_par_cue2vs1
trace_par_cue4vs2 = trace_par_cue4vs1-trace_par_cue2vs1
trace_par_cue4vs3 = trace_par_cue4vs1-trace_par_cue3vs1
hdi_3vs2 <- bayestestR::hdi(trace_par_cue3vs2, ci = 0.95)
rope_res_2 <- bayestestR::rope(trace_par_cue3vs2, range = c(-0.1,0.1))
hdi_4vs2 <- bayestestR::hdi(trace_par_cue4vs2, ci = 0.95)
rope_res_3 <- bayestestR::rope(trace_par_cue4vs2, range = c(-0.1,0.1))
hdi_4vs3 <- bayestestR::hdi(trace_par_cue4vs3, ci = 0.95)
rope_res_4 <- bayestestR::rope(trace_par_cue4vs3, range = c(-0.1,0.1))
p_3vs2 <- plot(rope_res_2, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue3vs2'))
p_4vs2 <- plot(rope_res_3, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs2'))
p_4vs3 <- plot(rope_res_4, rope_color = "grey70") +
papaja::theme_apa() +
ggtitle(paste(model_name, 'cue4vs3'))
plot_list <- c(plot_list, p_3vs2, p_4vs2, p_4vs3)
}
final_plot_analysis_2 <- patchwork::wrap_plots(plot_list, ncol = 3)
final_plot_analysis_2+ggview::canvas(width = 400,height = 200*2/3, units = "mm", dpi = 320)
ggplot2::ggsave(
filename = '../figure/final_plot_analysis_2.jpg',
plot = final_plot_analysis_2,
width = 400,
height = 200*2/3,
units = "mm",
dpi = 320
)
model_rt
p_acc = ggplot(data = data_analysis, mapping = aes(x = cue_dimensionality, y = mean_acc, fill = cue_dimensionality)) +
sm_raincloud() +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
p_rt = ggplot(data = data_analysis, mapping = aes(x = cue_dimensionality, y = media_rt, fill = cue_dimensionality)) +
sm_raincloud() +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
p_acc+p_rt+ggview::canvas(width = 300,height = 200*2/3, units = "mm", dpi = 320)
p_analysis_2_describe = p_acc+p_rt
ggplot2::ggsave(
filename = '../figure/p_analysis_2_describe.jpg',
plot = p_analysis_2_describe,
width = 300,
height = 200*2/3,
units = "mm",
dpi = 320
)
