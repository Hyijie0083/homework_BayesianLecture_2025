coord_cartesian(xlim = c(-1, 1), clip = "off") +
theme(
axis.text = element_text(size = 8),
panel.grid = element_blank(),
text = element_text(family = 'serif'),
panel.spacing = unit(0.2, "cm"),
strip.text.y = element_blank(),
strip.placement = "outside",
strip.background = element_blank(),
plot.margin = margin(r = 200)
) +
geom_text(
data = pipeline_labels,
aes(x = Inf, y = 0, label = label),
hjust = -0.1, vjust = -2, size = 4, family = 'serif'
)
plot_list <- c(plot_list, figure)
}
print(plot_list)
# Save interaction effect plots
#for (i in seq_along(plot_list)) {
#  col_idx <- i + 1  # 因为 col_interaction 从 2 开始：i=1 → col=2
#  filename <- glue::glue("../figure/interaction_effect_{col_idx}.png")
#  ggsave(
#    filename = filename,
#    plot = plot_list[[i]],
#    width = 200,
#    height = 200*2/3,
#    units = "mm",
#    dpi = 320
# )
#}
library(brms)
library(tidyverse)
library(bruceR)
library(bayestestR)
library(papaja)
library(smplot2)
library(patchwork)
PATH = '../results/hddm/dic_model_full.csv'
data_plot_dic = read.csv(PATH)
View(data_plot_dic)
data_plot_dic = read.csv(PATH)
ggplot(data = data_plot_dic, mapping = aes(x = model, y = DIC, fill = DIC)) +
sm_bar(
bar.params = list(width = 0.5, alpha = 0.5),
point.params = list(
shape = 21, color = "white",
stroke = 0.75, alpha = 1
)
) +
scale_y_continuous(limits = c(-5, 15), expand = c(0, 0.05)) +
scale_fill_manual(values = sm_color('wine','skyblue','lightbrown','yelloworange'))
data_plot_dic = read.csv(PATH)
ggplot(data = data_plot_dic, mapping = aes(x = model, y = DIC, fill = DIC)) +
smplot2::sm_bar(
bar.params = list(width = 0.5, alpha = 0.5),
point.params = list(
shape = 21, color = "white",
stroke = 0.75, alpha = 1
)
) +
scale_y_continuous(limits = c(-5, 15), expand = c(0, 0.05)) +
scale_fill_manual(values = sm_color('wine','skyblue','lightbrown','yelloworange'))
data_plot_dic = read.csv(PATH)
ggplot(data = data_plot_dic, mapping = aes(x = model, y = DIC, fill = DIC)) +
smplot2::sm_bar() +
scale_fill_manual(values = sm_color('wine','skyblue','lightbrown','yelloworange'))
data_plot_dic = read.csv(PATH)
ggplot(data = data_plot_dic, mapping = aes(x = model, y = DIC)) +
smplot2::sm_bar() +
scale_fill_manual(values = sm_color('wine','skyblue','lightbrown','yelloworange'))
?sm_bar
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC)) +
smplot2::sm_bar(
bar.params = list(width = 0.5, alpha = 1, color = "transparent", fill = "black")
)
?sm_bar
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC)) +
smplot2::sm_bar(
bar.params = list(width = 0.2, alpha = 1, color = "transparent", fill = "black")
)
PATH <- '../results/hddm/dic_model_full.csv'
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC)) +
smplot2::sm_bar(
bar.params = list(width = 0.2, alpha = 1, color = "transparent", fill = "black")
)
library(brms)
library(tidyverse)
library(bruceR)
library(bayestestR)
library(papaja)
library(smplot2)
library(patchwork)
PATH <- '../results/hddm/dic_model_full.csv'
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC)) +
smplot2::sm_bar(
bar.params = list(width = 0.2, alpha = 1, color = "transparent", fill = "yelloworange")
)
View(data_dic_difference)
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC)) +
smplot2::sm_bar(
bar.params = list(width = 0.2, alpha = 1, color = "transparent", fill = "wine")
)
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC)) +
smplot2::sm_bar(
bar.params = list(width = 0.2, alpha = 1, color = "transparent")#, fill = "wine"
)+
scale_fill_manual(values = sm_color('wine','skyblue','lightbrown'))
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.2)
)+
scale_y_continuous(
name = "DIC (×10³)"
)
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)",
breaks = seq(0, max(data_dic_difference$DIC), by = 1000)
)
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)",
breaks = seq(0, max(data_dic_difference$DIC), by = 1)
)
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
figure_dic = ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)+
ggview::canvas(width = 400,height = 200*2/3, units = "mm", dpi = 320)
figure_dic
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
figure_dic = ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)+
ggview::canvas(width = 400,height = 300*2/3, units = "mm", dpi = 320)
figure_dic
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
figure_dic = ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)+
ggview::canvas(width = 400,height = 400*2/3, units = "mm", dpi = 320)
figure_dic
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
figure_dic = ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)+
ggview::canvas(width = 200,height = 400*2/3, units = "mm", dpi = 320)
figure_dic
data_dic <- read.csv(PATH)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
figure_dic = ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)
figure_dic+ggview::canvas(width = 200,height = 400*2/3, units = "mm", dpi = 320)
ggsave(
filename = '../figure/plot_dic.jpg',
plot = figure_dic,
width = 200,
height = 400*2/3,
units = "mm",
dpi = 320
)
data_posterior_a <- read.csv(PATH_A)
PATH_DIC <- '../results/hddm/dic_model_full.csv'
PATH_A <- '../results/hddm/data_posterior_a.csv'
PATH_V <- '../results/hddm/data_posterior_v.csv'
data_posterior_a <- read.csv(PATH_A)
View(data_posterior_a)
data_posterior_a <- read.csv(PATH_A)
data_posterior_a_long <- data_posterior_a %>%
dplyr::pivot_longer(
cols = severything(),      # 指定要“拉长”的列（可用 : 、c()、starts_with 等）
names_to = "a_condition",               # 新列名：存储原列名（如 "time1", "time2"）
values_to = "a_value"              # 新列名：存储原列的值
)
data_posterior_a <- read.csv(PATH_A)
data_posterior_a_long <- data_posterior_a %>%
tidyr::pivot_longer(
cols = severything(),      # 指定要“拉长”的列（可用 : 、c()、starts_with 等）
names_to = "a_condition",               # 新列名：存储原列名（如 "time1", "time2"）
values_to = "a_value"              # 新列名：存储原列的值
)
data_posterior_a <- read.csv(PATH_A)
data_posterior_a_long <- data_posterior_a %>%
tidyr::pivot_longer(
cols = everything(),      # 指定要“拉长”的列（可用 : 、c()、starts_with 等）
names_to = "a_condition",               # 新列名：存储原列名（如 "time1", "time2"）
values_to = "a_value"              # 新列名：存储原列的值
)
View(data_posterior_a_long)
View(data_dic_difference)
View(data_posterior_a)
data_posterior_a <- read.csv(PATH_A)
data_posterior_a_long <- data_posterior_a %>%
tidyr::pivot_longer(
cols = everything(),      # 指定要“拉长”的列（可用 : 、c()、starts_with 等）
names_to = "a_condition",               # 新列名：存储原列名（如 "time1", "time2"）
values_to = "a_value"              # 新列名：存储原列的值
)
figure_hddm_a = ggplot(data = data_posterior_a_long, mapping = aes(x = a_condition, y = a_value, fill = a_condition)) +
sm_raincloud() +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
figure_hddm_a+ggview::canvas(width = 200,height = 400*2/3, units = "mm", dpi = 320)
data_posterior_a <- read.csv(PATH_A)
data_posterior_a_long <- data_posterior_a %>%
tidyr::pivot_longer(
cols = everything(),      # 指定要“拉长”的列（可用 : 、c()、starts_with 等）
names_to = "a_condition",               # 新列名：存储原列名（如 "time1", "time2"）
values_to = "a_value"              # 新列名：存储原列的值
)
model_a <- brms::brm(
a_value ~ 1 + a_condition,
data = data_posterior_a_long,
family = gaussian(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
saveRDS(model_list_analysis_2, "../results/hddm/statistic_inference/model_a.rds")
saveRDS(model_a, "../results/hddm/statistic_inference/model_a.rds")
figure_hddm_a = ggplot(data = data_posterior_a_long, mapping = aes(x = a_condition, y = a_value, fill = a_condition)) +
sm_raincloud(which_side = "l") +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
figure_hddm_a+ggview::canvas(width = 200,height = 400*2/3, units = "mm", dpi = 320)
figure_hddm_a = ggplot(data = data_posterior_a_long, mapping = aes(x = a_condition, y = a_value, fill = a_condition)) +
sm_raincloud(which_side = "l") +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
figure_hddm_a+ggview::canvas(width = 400,height = 400*2/3, units = "mm", dpi = 320)
data_posterior_v <- read.csv(PATH_V)
data_posterior_v_long <- data_posterior_v %>%
tidyr::pivot_longer(
cols = everything(),
names_to = "v_condition",
values_to = "v_value"
)
# plot
figure_hddm_v = ggplot(data = data_posterior_v_long, mapping = aes(x = v_condition, y = v_value, fill = v_condition)) +
sm_raincloud(which_side = "l") +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
figure_hddm_v+ggview::canvas(width = 400,height = 400*2/3, units = "mm", dpi = 320)
figure_hddm_v+ggview::canvas(width = 300,height = 400*2/3, units = "mm", dpi = 320)
figure_hddm_a+ggview::canvas(width = 300,height = 400*2/3, units = "mm", dpi = 320)
ggsave(
filename = '../figure/plot_hddm_a.jpg',
plot = figure_dic,
width = 300,
height = 400*2/3,
units = "mm",
dpi = 320
)
ggsave(
filename = '../figure/plot_hddm_a.jpg',
plot = figure_hddm_a,
width = 300,
height = 400*2/3,
units = "mm",
dpi = 320
)
data_dic <- read.csv(PATH_DIC)
data_dic_difference <- data_dic[2:5,]
data_dic_difference[, 2] <- data_dic_difference[, 2] - data_dic[1, 2]
figure_dic = ggplot(data = data_dic_difference, mapping = aes(x = model, y = DIC/1000)) +
smplot2::sm_bar(
bar.params = list(width = 0.5)
)+
scale_y_continuous(
name = "DIC (×10³)"
)
figure_dic+ggview::canvas(width = 200,height = 400*2/3, units = "mm", dpi = 320)
ggsave(
filename = '../figure/plot_dic.jpg',
plot = figure_dic,
width = 200,
height = 400*2/3,
units = "mm",
dpi = 320
)
data_posterior_v <- read.csv(PATH_V)
data_posterior_v_long <- data_posterior_v %>%
tidyr::pivot_longer(
cols = everything(),
names_to = "v_condition",
values_to = "v_value"
)
model_v <- brms::brm(
v_value ~ 1 + v_condition,
data = data_posterior_v_long,
family = gaussian(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
saveRDS(model_v, "../results/hddm/statistic_inference/model_v.rds")
# plot
figure_hddm_v = ggplot(data = data_posterior_v_long, mapping = aes(x = v_condition, y = v_value, fill = v_condition)) +
sm_raincloud(which_side = "l") +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
figure_hddm_v+ggview::canvas(width = 300,height = 400*2/3, units = "mm", dpi = 320)
ggsave(
filename = '../figure/plot_hddm_v.jpg',
plot = figure_hddm_v,
width = 300,
height = 400*2/3,
units = "mm",
dpi = 320
)
data_posterior_a <- read.csv(PATH_A)
data_posterior_a_long <- data_posterior_a %>%
tidyr::pivot_longer(
cols = everything(),
names_to = "a_condition",
values_to = "a_value"
)
data_posterior_v <- read.csv(PATH_V)
data_posterior_v_long <- data_posterior_v %>%
tidyr::pivot_longer(
cols = everything(),
names_to = "v_condition",
values_to = "v_value"
)
data_posterior_t <- read.csv(PATH_T)
PATH_DIC <- '../results/hddm/dic_model_full.csv'
PATH_A <- '../results/hddm/data_posterior_a.csv'
PATH_V <- '../results/hddm/data_posterior_v.csv'
PATH_T <- '../results/hddm/data_posterior_t.csv'
data_posterior_a <- read.csv(PATH_A)
data_posterior_a_long <- data_posterior_a %>%
tidyr::pivot_longer(
cols = everything(),
names_to = "a_condition",
values_to = "a_value"
)
data_posterior_v <- read.csv(PATH_V)
data_posterior_v_long <- data_posterior_v %>%
tidyr::pivot_longer(
cols = everything(),
names_to = "v_condition",
values_to = "v_value"
)
data_posterior_t <- read.csv(PATH_T)
data_posterior_t <- read.csv(PATH_T)
PATH_DIC <- '../results/hddm/dic_model_full.csv'
PATH_A <- '../results/hddm/data_posterior_a.csv'
PATH_V <- '../results/hddm/data_posterior_v.csv'
PATH_T <- '../results/hddm/data_posterior_t.csv'
data_posterior_t <- read.csv(PATH_T)
data_posterior_t_long <- data_posterior_t %>%
tidyr::pivot_longer(
cols = everything(),
names_to = "t_condition",
values_to = "t_value"
)
# t
figure_hddm_t = ggplot(data = data_posterior_t_long, mapping = aes(x = t_condition, y = t_value, fill = t_condition)) +
sm_raincloud(which_side = "l") +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
figure_hddm_v+ggview::canvas(width = 300,height = 400*2/3, units = "mm", dpi = 320)
figure_hddm_t = ggplot(data = data_posterior_t_long, mapping = aes(x = t_condition, y = t_value, fill = t_condition)) +
sm_raincloud(which_side = "l") +
scale_fill_manual(values = sm_color("darkred", "viridian",'yelloworange','wine'))
figure_hddm_t+ggview::canvas(width = 300,height = 400*2/3, units = "mm", dpi = 320)
ggsave(
filename = '../figure/plot_hddm_t.jpg',
plot = figure_hddm_t,
width = 300,
height = 400*2/3,
units = "mm",
dpi = 320
)
summary(model_a)
trace_par <- as.data.frame(model_a)
View(trace_par)
emm <- emmeans(model_v, ~ v_condition)
View(emm)
pairs_emm <- pairs(emm)
# 转为数据框，提取后验样本
diff_samples <- as_draws_df(pairs_emm)
emm <- emmeans(model_v, ~ v_condition)
# 计算所有两两差异（pairwise contrasts）
pairs_emm <- pairs(emm)
# 转为数据框，提取后验样本
diff_samples <- as_draws_df(pairs_emm)  # 或用: spread_draws(pairs_emm)
summary(pairs_emm)
emmeans_a <- emmeans(model_a, ~ a_condition)
compare_pairs_a<- pairs(emmeans_a)
summary(compare_pairs_a)
emmeans_v <- emmeans(model_v, ~ v_condition)
compare_pairs_v<- pairs(emmeans_v)
summary(compare_pairs_v)
emmeans_t <- emmeans(model_t, ~ t_condition)
model_a <- brms::brm(
a_value ~ 1 + a_condition,
data = data_posterior_a_long,
family = gaussian(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
saveRDS(model_a, "../results/hddm/statistic_inference/model_a.rds")
model_v <- brms::brm(
v_value ~ 1 + v_condition,
data = data_posterior_v_long,
family = gaussian(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
saveRDS(model_v, "../results/hddm/statistic_inference/model_v.rds")
model_t <- brms::brm(
t_value ~ 1 + t_condition,
data = data_posterior_t_long,
family = gaussian(),
iter = 2000,
warmup = 1000,
chains = 4,
cores = 4,
seed = 42)
saveRDS(model_t, "../results/hddm/statistic_inference/model_t.rds")
emmeans_a <- emmeans(model_a, ~ a_condition)
compare_pairs_a<- pairs(emmeans_a)
summary(compare_pairs_a)
emmeans_v <- emmeans(model_v, ~ v_condition)
compare_pairs_v<- pairs(emmeans_v)
summary(compare_pairs_v)
emmeans_t <- emmeans(model_t, ~ t_condition)
compare_pairs_t<- pairs(emmeans_t)
summary(compare_pairs_t)
